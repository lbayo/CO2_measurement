
from machine import SoftI2C,Pin
from utime import sleep
import framebuf
import ssd1306
from oled import Write, GFX, SSD1306_I2C
from oled.fonts import ubuntu_mono_15, ubuntu_mono_20

def logo(oled):
    '''
    data=(
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xfe, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x03, 0xf0, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0xff, 0xfc, 0x03, 0xf8, \
    0xfe, 0x00, 0x0f, 0xff, 0xfe, 0x03, 0xf8, \
    0xfe, 0x00, 0x7f, 0xff, 0xfe, 0x03, 0xf8, \
    0xfe, 0x01, 0xff, 0xff, 0xfc, 0x03, 0xf8, \
    0xfe, 0x03, 0xff, 0xff, 0xf8, 0x03, 0xf8, \
    0xfe, 0x07, 0xff, 0xff, 0xf0, 0x03, 0xf8, \
    0xfe, 0x0f, 0xff, 0xff, 0xe0, 0x03, 0xf8, \
    0xfe, 0x0f, 0xff, 0xff, 0x80, 0x03, 0xf8, \
    0xfe, 0x07, 0xff, 0xfc, 0x00, 0x03, 0xf8, \
    0xfe, 0x03, 0xff, 0xc0, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0xfc, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x03, 0xf0, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0xff, 0xfc, 0x03, 0xf8, \
    0xfe, 0x00, 0x0f, 0xff, 0xfe, 0x03, 0xf8, \
    0xfe, 0x00, 0x7f, 0xff, 0xfe, 0x03, 0xf8, \
    0xfe, 0x01, 0xff, 0xff, 0xfc, 0x03, 0xf8, \
    0xfe, 0x03, 0xff, 0xff, 0xf8, 0x03, 0xf8, \
    0xfe, 0x07, 0xff, 0xff, 0xf0, 0x03, 0xf8, \
    0xfe, 0x0f, 0xff, 0xff, 0xe0, 0x03, 0xf8, \
    0xfe, 0x0f, 0xff, 0xff, 0x80, 0x03, 0xf8, \
    0xfe, 0x07, 0xff, 0xfc, 0x00, 0x03, 0xf8, \
    0xfe, 0x03, 0xff, 0xc0, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0xfc, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x03, 0xf0, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0xff, 0xfc, 0x03, 0xf8, \
    0xfe, 0x00, 0x0f, 0xff, 0xfe, 0x03, 0xf8, \
    0xfe, 0x00, 0x7f, 0xff, 0xfe, 0x03, 0xf8, \
    0xfe, 0x01, 0xff, 0xff, 0xfc, 0x03, 0xf8, \
    0xfe, 0x03, 0xff, 0xff, 0xf8, 0x03, 0xf8, \
    0xfe, 0x07, 0xff, 0xff, 0xf0, 0x03, 0xf8, \
    0xfe, 0x0f, 0xff, 0xff, 0xe0, 0x03, 0xf8, \
    0xfe, 0x0f, 0xff, 0xff, 0x80, 0x03, 0xf8, \
    0xfe, 0x07, 0xff, 0xfc, 0x00, 0x03, 0xf8, \
    0xfe, 0x03, 0xff, 0xc0, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0xfc, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, \
    0xfe, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, \
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8 \
    )
    data=bytearray(data)
    print (data)
    '''
    with open("logo","b") as f:
        x=f.read()
    fbuf = framebuf.FrameBuffer(bytearray(x), 56, 56, framebuf.MONO_HLSB)
    oled.fill(0)
    oled.blit(fbuf, 0, 0)          # Framebuffer y punto de inicio de representación
    oled.show()                    # Muestra el resultado

def Copyright(oled):
    lg=(\
        0x07,0x00,\
        0x18,0xe0,\
        0x20,0x20,\
        0x47,0x10,\
        0x48,0x90,\
        0x90,0x08,\
        0x90,0x08,\
        0x90,0x08,\
        0x90,0x08,\
        0x48,0x90,\
        0x47,0x10,\
        0x20,0x20,\
        0x18,0xe0,\
        0x07,0x00\
    )
    data=bytearray(lg)
    fbuf = framebuf.FrameBuffer(data, 13, 14, framebuf.MONO_HLSB)
    oled.blit(fbuf, 114, 50)          # Framebuffer y punto de inicio de representación
    oled.show()                    # Muestra el resultado
'''
def main():
    i2c = SoftI2C(scl=Pin(22), sda=Pin(21))   # instancia bus I2C en pin 21 y 22
    oled = ssd1306.SSD1306_I2C(128, 64, i2c)                  # instancia Display OLED
    
    logo(oled)    
    Copyright(oled)
    sleep(2)
    
    write15 = Write(oled, ubuntu_mono_15)  
    write20 = Write(oled, ubuntu_mono_20)
    write20.text("Medidor"  ,60, 0)
    write20.text("de CO2"   ,60,16)
    write15.text("R.Carreno",60,34)
    write15.text("L.Bayo"   ,60,46)
    oled.pixel (110,37,1); oled.pixel (111,37,1); oled.pixel (112,37,1); oled.pixel (113,37,1) # Ñ
    oled.pixel ( 99,49,1); oled.pixel (100,48,1); oled.pixel (101,47,1) # Ó
    sleep(2)
    oled.fill(0)
    write20.text("eCO2:%4d%cppm"%(400 ,'~') , 0, 12)
    write20.text("TVOC:%4d%cppb"%(  4 ,'~') , 0, 34)
    write15.text("T: %4.1fC   Hum:%2d%%"%(20,50), 0, 52)
    oled.show()
    sleep(2)
    oled.fill(0)
    

if __name__ == "__main__":
    main()
'''    
